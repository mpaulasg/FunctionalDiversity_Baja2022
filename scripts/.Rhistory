plot_asb_nm              = c("Kelp", "Rocky"),
ind_nm                   = c("fric"),
faxes                    = paste0("PC", 1:4),
faxes_nm                 = NULL,
range_faxes              = c(NA, NA),
color_bg                 = "grey95",
shape_sp                 = c(pool = 3, asb1 = 21, asb2 = 21),
size_sp                  = c(pool = 0.7, asb1 = 1, asb2 = 1),
color_sp                 = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
color_vert               = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
fill_sp                  = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_vert                = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
color_ch                 = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_ch                  = c(pool = "white", asb1 = "mediumseagreen", asb2 = "sienna"),
alpha_ch                 = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
shape_centroid_fdis      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fdiv      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fspe      = 23,
color_centroid_fspe      = "black",
size_sp_nm               = 3,
#color_sp_nm              = "black",
plot_sp_nm               = c("Paralabrax.nebulifer" ),
#fontface_sp_nm           = "plain",
save_file                = FALSE,
check_input              = TRUE)
plot_fric <- plots_alpha$"fric"$"patchwork"
plot_fric
plots_alpha <- mFD::alpha.multidim.plot(
output_alpha_fd_multidim = fd_habitat,
plot_asb_nm              = c("Kelp", "Rocky"),
ind_nm                   = c("fric"),
faxes                    = paste0("PC", 1:4),
faxes_nm                 = NULL,
range_faxes              = c(NA, NA),
color_bg                 = "grey95",
shape_sp                 = c(pool = 3, asb1 = 21, asb2 = 21),
size_sp                  = c(pool = 0.7, asb1 = 1, asb2 = 1),
color_sp                 = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
color_vert               = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
fill_sp                  = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_vert                = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
color_ch                 = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_ch                  = c(pool = "white", asb1 = "mediumseagreen", asb2 = "sienna"),
alpha_ch                 = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
shape_centroid_fdis      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fdiv      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fspe      = 23,
color_centroid_fspe      = "black",
size_sp_nm               = 3,
#color_sp_nm              = "black",
plot_sp_nm               = c("Paralabrax.nebulifer" ),
#fontface_sp_nm           = "plain",
save_file                = FALSE,
check_input              = TRUE)
plot_fric <- plots_alpha$"fric"$"patchwork"
plot_fric
plots_alpha <- mFD::alpha.multidim.plot(
output_alpha_fd_multidim = fd_habitat,
plot_asb_nm              = c("Kelp", "Rocky"),
ind_nm                   = c("fric"),
faxes                    = paste0("PC", 1:4),
faxes_nm                 = NULL,
range_faxes              = c(NA, NA),
color_bg                 = "grey95",
shape_sp                 = c(pool = 3, asb1 = 21, asb2 = 21),
size_sp                  = c(pool = 0.7, asb1 = 1, asb2 = 1),
color_sp                 = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
color_vert               = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
fill_sp                  = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_vert                = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
color_ch                 = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_ch                  = c(pool = "white", asb1 = "mediumseagreen", asb2 = "sienna"),
alpha_ch                 = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
shape_centroid_fdis      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fdiv      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fspe      = 23,
color_centroid_fspe      = "black",
size_sp_nm               = 3,
#color_sp_nm              = "black",
plot_sp_nm               = c("Sebastes.carnatus" ),
#fontface_sp_nm           = "plain",
save_file                = FALSE,
check_input              = TRUE)
plot_fric <- plots_alpha$"fric"$"patchwork"
plot_fric
plots_alpha <- mFD::alpha.multidim.plot(
output_alpha_fd_multidim = fd_habitat,
plot_asb_nm              = c("Kelp", "Rocky"),
ind_nm                   = c("fric"),
faxes                    = paste0("PC", 1:4),
faxes_nm                 = NULL,
range_faxes              = c(NA, NA),
color_bg                 = "grey95",
shape_sp                 = c(pool = 3, asb1 = 21, asb2 = 21),
size_sp                  = c(pool = 0.7, asb1 = 1, asb2 = 1),
color_sp                 = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
color_vert               = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
fill_sp                  = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_vert                = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
color_ch                 = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_ch                  = c(pool = "white", asb1 = "mediumseagreen", asb2 = "sienna"),
alpha_ch                 = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
shape_centroid_fdis      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fdiv      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fspe      = 23,
color_centroid_fspe      = "black",
size_sp_nm               = 3,
#color_sp_nm              = "black",
plot_sp_nm               = c("Phanerodon.furcatus" ),
#fontface_sp_nm           = "plain",
save_file                = FALSE,
check_input              = TRUE)
plot_fric <- plots_alpha$"fric"$"patchwork"
plot_fric
plots_alpha <- mFD::alpha.multidim.plot(
output_alpha_fd_multidim = fd_habitat,
plot_asb_nm              = c("Kelp", "Rocky"),
ind_nm                   = c("fric"),
faxes                    = paste0("PC", 1:4),
faxes_nm                 = NULL,
range_faxes              = c(NA, NA),
color_bg                 = "grey95",
shape_sp                 = c(pool = 3, asb1 = 21, asb2 = 21),
size_sp                  = c(pool = 0.7, asb1 = 1, asb2 = 1),
color_sp                 = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
color_vert               = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
fill_sp                  = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_vert                = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
color_ch                 = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_ch                  = c(pool = "white", asb1 = "mediumseagreen", asb2 = "sienna"),
alpha_ch                 = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
shape_centroid_fdis      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fdiv      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fspe      = 23,
color_centroid_fspe      = "black",
size_sp_nm               = 3,
#color_sp_nm              = "black",
plot_sp_nm               = c("Sebastes.chrysomelas" ),
#fontface_sp_nm           = "plain",
save_file                = FALSE,
check_input              = TRUE)
plot_fric <- plots_alpha$"fric"$"patchwork"
plot_fric
plots_alpha <- mFD::alpha.multidim.plot(
output_alpha_fd_multidim = fd_habitat,
plot_asb_nm              = c("Kelp", "Rocky"),
ind_nm                   = c("fric"),
faxes                    = paste0("PC", 1:4),
faxes_nm                 = NULL,
range_faxes              = c(NA, NA),
color_bg                 = "grey95",
shape_sp                 = c(pool = 3, asb1 = 21, asb2 = 21),
size_sp                  = c(pool = 0.7, asb1 = 1, asb2 = 1),
color_sp                 = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
color_vert               = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
fill_sp                  = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_vert                = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
color_ch                 = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_ch                  = c(pool = "white", asb1 = "mediumseagreen", asb2 = "sienna"),
alpha_ch                 = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
shape_centroid_fdis      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fdiv      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fspe      = 23,
color_centroid_fspe      = "black",
size_sp_nm               = 3,
#color_sp_nm              = "black",
plot_sp_nm               = c("Atherinops.sp" ),
#fontface_sp_nm           = "plain",
save_file                = FALSE,
check_input              = TRUE)
plot_fric <- plots_alpha$"fric"$"patchwork"
plot_fric
plots_alpha <- mFD::alpha.multidim.plot(
output_alpha_fd_multidim = fd_habitat,
plot_asb_nm              = c("Kelp", "Rocky"),
ind_nm                   = c("fric"),
faxes                    = paste0("PC", 1:4),
faxes_nm                 = NULL,
range_faxes              = c(NA, NA),
color_bg                 = "grey95",
shape_sp                 = c(pool = 3, asb1 = 21, asb2 = 21),
size_sp                  = c(pool = 0.7, asb1 = 1, asb2 = 1),
color_sp                 = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
color_vert               = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
fill_sp                  = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_vert                = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
color_ch                 = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_ch                  = c(pool = "white", asb1 = "mediumseagreen", asb2 = "sienna"),
alpha_ch                 = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
shape_centroid_fdis      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fdiv      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fspe      = 23,
color_centroid_fspe      = "black",
size_sp_nm               = 3,
#color_sp_nm              = "black",
plot_sp_nm               = c("Oxylebius.pictus" ),
#fontface_sp_nm           = "plain",
save_file                = FALSE,
check_input              = TRUE)
plot_fric <- plots_alpha$"fric"$"patchwork"
plot_fric
plots_alpha <- mFD::alpha.multidim.plot(
output_alpha_fd_multidim = fd_habitat,
plot_asb_nm              = c("Kelp", "Rocky"),
ind_nm                   = c("fric"),
faxes                    = paste0("PC", 1:4),
faxes_nm                 = NULL,
range_faxes              = c(NA, NA),
color_bg                 = "grey95",
shape_sp                 = c(pool = 3, asb1 = 21, asb2 = 21),
size_sp                  = c(pool = 0.7, asb1 = 1, asb2 = 1),
color_sp                 = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
color_vert               = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
fill_sp                  = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_vert                = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
color_ch                 = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_ch                  = c(pool = "white", asb1 = "mediumseagreen", asb2 = "sienna"),
alpha_ch                 = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
shape_centroid_fdis      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fdiv      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fspe      = 23,
color_centroid_fspe      = "black",
size_sp_nm               = 3,
#color_sp_nm              = "black",
plot_sp_nm               = c("Hypsypops.rubicundus" ),
#fontface_sp_nm           = "plain",
save_file                = FALSE,
check_input              = TRUE)
plot_fric <- plots_alpha$"fric"$"patchwork"
plot_fric
plots_alpha <- mFD::alpha.multidim.plot(
output_alpha_fd_multidim = fd_habitat,
plot_asb_nm              = c("Kelp", "Rocky"),
ind_nm                   = c("fric"),
faxes                    = paste0("PC", 1:4),
faxes_nm                 = NULL,
range_faxes              = c(NA, NA),
color_bg                 = "grey95",
shape_sp                 = c(pool = 3, asb1 = 21, asb2 = 21),
size_sp                  = c(pool = 0.7, asb1 = 1, asb2 = 1),
color_sp                 = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
color_vert               = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
fill_sp                  = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_vert                = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
color_ch                 = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_ch                  = c(pool = "white", asb1 = "mediumseagreen", asb2 = "sienna"),
alpha_ch                 = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
shape_centroid_fdis      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fdiv      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fspe      = 23,
color_centroid_fspe      = "black",
size_sp_nm               = 3,
#color_sp_nm              = "black",
plot_sp_nm               = c("Rhacochilus.vacca" ),
#fontface_sp_nm           = "plain",
save_file                = FALSE,
check_input              = TRUE)
plot_fric <- plots_alpha$"fric"$"patchwork"
plot_fric
plots_alpha <- mFD::alpha.multidim.plot(
output_alpha_fd_multidim = fd_habitat,
plot_asb_nm              = c("Kelp", "Rocky"),
ind_nm                   = c("fric"),
faxes                    = paste0("PC", 1:4),
faxes_nm                 = NULL,
range_faxes              = c(NA, NA),
color_bg                 = "grey95",
shape_sp                 = c(pool = 3, asb1 = 21, asb2 = 21),
size_sp                  = c(pool = 0.7, asb1 = 1, asb2 = 1),
color_sp                 = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
color_vert               = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
fill_sp                  = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_vert                = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
color_ch                 = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_ch                  = c(pool = "white", asb1 = "mediumseagreen", asb2 = "sienna"),
alpha_ch                 = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
shape_centroid_fdis      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fdiv      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fspe      = 23,
color_centroid_fspe      = "black",
size_sp_nm               = 3,
#color_sp_nm              = "black",
plot_sp_nm               = c("Sebastes.auriculatus" ),
#fontface_sp_nm           = "plain",
save_file                = FALSE,
check_input              = TRUE)
plot_fric <- plots_alpha$"fric"$"patchwork"
plot_fric
habitat_fric[2,]
plots_alpha <- mFD::alpha.multidim.plot(
output_alpha_fd_multidim = fd_habitat,
plot_asb_nm              = c("Kelp", "Rocky"),
ind_nm                   = c("fric"),
faxes                    = paste0("PC", 1:4),
faxes_nm                 = NULL,
range_faxes              = c(NA, NA),
color_bg                 = "grey95",
shape_sp                 = c(pool = 3, asb1 = 21, asb2 = 21),
size_sp                  = c(pool = 0.7, asb1 = 1, asb2 = 1),
color_sp                 = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
color_vert               = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
fill_sp                  = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_vert                = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
color_ch                 = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_ch                  = c(pool = "white", asb1 = "mediumseagreen", asb2 = "sienna"),
alpha_ch                 = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
shape_centroid_fdis      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fdiv      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fspe      = 23,
color_centroid_fspe      = "black",
size_sp_nm               = 3,
#color_sp_nm              = "black",
plot_sp_nm               = c("Brachyistius.frenatus" ),
#fontface_sp_nm           = "plain",
save_file                = FALSE,
check_input              = TRUE)
plot_fric <- plots_alpha$"fric"$"patchwork"
plot_fric
plots_alpha <- mFD::alpha.multidim.plot(
output_alpha_fd_multidim = fd_habitat,
plot_asb_nm              = c("Kelp", "Rocky"),
ind_nm                   = c("fric"),
faxes                    = paste0("PC", 1:4),
faxes_nm                 = NULL,
range_faxes              = c(NA, NA),
color_bg                 = "grey95",
shape_sp                 = c(pool = 3, asb1 = 21, asb2 = 21),
size_sp                  = c(pool = 0.7, asb1 = 1, asb2 = 1),
color_sp                 = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
color_vert               = c(pool = "grey50", asb1 = "mediumseagreen", asb2 = "sienna"),
fill_sp                  = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_vert                = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
color_ch                 = c(pool = NA, asb1 = "mediumseagreen", asb2 = "sienna"),
fill_ch                  = c(pool = "white", asb1 = "mediumseagreen", asb2 = "sienna"),
alpha_ch                 = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
shape_centroid_fdis      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fdiv      = c(asb1 = 22,  asb2 = 24),
shape_centroid_fspe      = 23,
color_centroid_fspe      = "black",
size_sp_nm               = 3,
#color_sp_nm              = "black",
plot_sp_nm               = c("Haemulon.californiensis" ),
#fontface_sp_nm           = "plain",
save_file                = FALSE,
check_input              = TRUE)
plot_fric <- plots_alpha$"fric"$"patchwork"
plot_fric
rm(list=ls()) # cleaning memory
#load packages
library(here)
library(tidyverse)
library(dplyr)
library(ggpubr)
library(car)
library(glmmTMB)
library(emmeans)
library(ggplot2)
library(dplyr)
library(DHARMa)
# Load data
fd_values <- read.csv(here::here("data", "fd_values_replicates.csv"))
metadata <- read.csv(here::here("data", "kelp&rocky_metadata_replicate.csv"))
habitat_kelp <- read.csv(here::here("data", "habitat_kelp.csv"))
habitat_RR <- read.csv(here::here("data", "habitat_RR.csv"))
#Prepare data for stats
fd_stats <- fd_values %>%
left_join(metadata, by=c("X"="Code")) %>%
select(-X, -HabitatID, -Replicate) %>%
relocate(Site, Habitat, .before = "sp_richn")
##### t test between habitats (RR and KF) #####
##Species richness
#Normality - QQ plots
sp_kelp <- fd_stats %>%
filter(Habitat =="Kelp")
sp_rocky<- fd_stats %>%
filter(Habitat =="Rocky")
ggqqplot(sp_kelp$sp_richn)
ggqqplot(sp_rocky$sp_richn)    # Both good
t.test(sp_kelp$sp_richn,sp_rocky$sp_richn, var.equal=TRUE)
#No differences between habitats - p=0.46
##Functional richness
#Normality
ggqqplot(sp_kelp$fric)
ggqqplot(sp_rocky$fric)   # Both good
t.test(sp_kelp$fric,sp_rocky$fric, var.equal=TRUE)
#No differences between habitats - p=0.74
##Functional evenness
#Normality
ggqqplot(sp_kelp$feve)
ggqqplot(sp_rocky$feve)  # This one is not good, so we will do
#a Wilcoxon Test
wilcox.test(sp_kelp$feve,sp_rocky$feve, paired = TRUE)
#No Differences between habitats - p=0.23
##Functional divergence
#Normality
ggqqplot(sp_kelp$fdiv)
ggqqplot(sp_rocky$fdiv)   #Both good
t.test(sp_kelp$fdiv,sp_rocky$fdiv, var.equal=TRUE)
### Differences between habitats - p=0.02
ggboxplot(fd_stats, x = "Habitat", y = "fdiv",
color = "Habitat",palette = c("#00AFBB", "#E7B800"),
ylab = "Functional Divergence", xlab = "")
##### ANOVA between sites (within each habitat) #####
############################KELP FORESTS #############################
## S
s_KF <- aov(sp_richn ~ Site, data=sp_kelp)
summary(s_KF)
#Not significant - p=0.937
#Normality
ggqqplot(s_KF$residuals) #Good
#Homogeneity of variances
bartlett.test(sp_richn ~ Site, data=sp_kelp)  #p=0.6148
## Fric
fric_KF <- aov(fric ~ Site, data=sp_kelp)
summary(fric_KF)
#No significant - p=0.427
#Normality
ggqqplot(fric_KF$residuals) #Good
#Homogeneity of variances
bartlett.test(fric ~ Site, data=sp_kelp)  #p=0.1778
## FEve
feve_KF <- aov(feve ~ Site, data=sp_kelp)
summary(feve_KF)
# Significant - p=0.0337
#Normality
ggqqplot(feve_KF$residuals) #Good
#Homogeneity of variances
bartlett.test(feve ~ Site, data=sp_kelp)  #p=0.42
## FDiv
fdiv_KF <- aov(fdiv ~ Site, data=sp_kelp)
summary(fdiv_KF)
###Not significant - p=0.5
#Normality
ggqqplot(fdiv_KF$residuals)
#Homogeneity of variances
bartlett.test(fdiv ~ Site, data=sp_kelp)  #p=0.78
####################ROCKY REEFS ######################
## S
s_RR <- aov(sp_richn ~ Site, data=sp_rocky)
summary(s_RR)
#Not significant - p=0.91
#Normality
ggqqplot(s_RR$residuals) #Good
#Homogeneity of variances
bartlett.test(sp_richn ~ Site, data=sp_rocky)  #p=0.88
## FRic
fric_RR <- aov(fric ~ Site, data=sp_rocky)
summary(fric_RR)
#Not significant - p=0.96
#Normality
ggqqplot(fric_RR$residuals) #Good
#Homogeneity of variances
bartlett.test(fric ~ Site, data=sp_rocky)  #p=0.09
##########NOW GLMM and HABITAT VARIABLES ######
##########KELP FORESTS ##########
### make tables to see if the variables are correlated
#Needs to eliminate site
correlation_KF <- habitat_kelp[-c(1)]
cor(correlation_KF) #stipes and diameter highly correlated - run 2 models with variables separated
## Join data
glmm_KF <- left_joi
glmm_KF <- left_join(habitat_kelp, fd_values, by = c("transect"="X"))
S_stipe <- glmmTMB (sp_richn ~ RI + Substrate + Stipes +
Ind_kelp+ (1|transect),data=glmm_KF, family = poisson())
summary (S_stipe)
Anova(S_stipe)#No significant variables
S_stipe1 <- glmmTMB (sp_richn ~ RI + Stipes
+ Ind_kelp+ (1|transect),data=glmm_KF, family = poisson())
summary (S_stipe1)
Anova(S_stipe1)#No significant variables
S_stipe2 <- glmmTMB (sp_richn ~  Substrate + Stipes +
Ind_kelp+ (1|transect),data=glmm_KF, family = poisson())
summary (S_stipe2) #No significant variables
Anova(S_stipe2)
S_stipe3 <- glmmTMB (sp_richn ~  Stipes + Ind_kelp+
(1|transect),data=glmm_KF, family = poisson())
summary (S_stipe3) #No significant variables
Anova(S_stipe3)
qqnorm(residuals(S_stipe))
simulationOutput <- simulateResiduals(fittedModel =S_stipe, n = 250)
fittedModel=S_stipe
plot(simulationOutput)
testDispersion(simulationOutput)
S_diameter <- glmmTMB (sp_richn ~ RI + Substrate +
Diameter + Ind_kelp+ (1|transect),data=glmm_KF, family = poisson())
summary (S_diameter) #No significant variables
Anova(S_diameter)
S_diameter1 <- glmmTMB (sp_richn ~ Substrate + Diameter +
Ind_kelp+ (1|transect),data=glmm_KF, family = poisson())
summary (S_diameter1) #No significant variables
Anova(S_diameter1)
S_diameter2 <- glmmTMB (sp_richn ~ RI + Diameter +
Ind_kelp+ (1|transect),data=glmm_KF, family = poisson())
summary (S_diameter2) #No significant variables
Anova(S_diameter2)
S_diameter3 <- glmmTMB (sp_richn ~ Diameter +
Ind_kelp+ (1|transect),data=glmm_KF, family = poisson())
summary (S_diameter3) #No significant variables
Anova(S_diameter3)
S_diameter4 <- glmmTMB (sp_richn ~ Ind_kelp+
(1|transect),data=glmm_KF, family = poisson())
summary (S_diameter4) #No significant variables
Anova(S_diameter4)
qqnorm(residuals(S_diameter))
simulationOutput <- simulateResiduals(fittedModel =S_diameter, n = 250)
fittedModel=S_diameter
plot(simulationOutput)
testDispersion(simulationOutput)
mod1_stipe <- glmmTMB (fric ~ RI + Stipes + Substrate +
Ind_kelp+ (1|transect),data=glmm_KF, family = beta_family())
summary (mod1_stipe)
Anova(mod1_stipe)
